<?xml version="1.0" encoding="utf-8"?>
<Configuration>
  <TaskConfiguration>
    <task name="PESP" type="blackboard" ver="1.0">
      <actors>
		<actor type="controller" as="AsInvoker"><path>%PROGPATH%\Canon\OIPPESP\Cnpspcnt.exe</path><Token>PESPControllerToken</Token><LogFilePath /><CfgFilePath>%COMMONAPPDATA%\Canon\OIPPESP\Cfg\Cnpspcnt.cfg</CfgFilePath></actor>
        <actor type="collector" as="AsInvoker"><path>%PROGPATH%\Canon\OIPPESP\Cnpspclt.exe</path><Token>PESPCollectorToken</Token><LogFilePath /><CfgFilePath>%COMMONAPPDATA%\Canon\OIPPESP\Cfg\Cnpspclt.cfg</CfgFilePath></actor>
        <actor type="uploader" as="AsUser"><path>%PROGPATH%\Canon\OIPPESP\Cnpspupl.exe</path><Token>PESPUploaderToken</Token><LogFilePath /><CfgFilePath>%COMMONAPPDATA%\Canon\OIPPESP\Cfg\Cnpspupl.cfg</CfgFilePath></actor>
        <actor type="logger" as="AsInvoker"><path>%PROGPATH%\Canon\OIPPESP\Cnpsplgr.exe</path><Token>PESPLoggerToken</Token><LogFilePath>%COMMONAPPDATA%\Canon\OIPPESP\Log\PESP.log</LogFilePath><CfgFilePath>%COMMONAPPDATA%\Canon\OIPPESP\Cfg\Cnpsplgr.cfg</CfgFilePath></actor>
        <actor type="updater" as="AsInvoker"><path>%PROGPATH%\Canon\OIPPESP\Cnpspupd.exe</path><Token>PESPUpdaterToken</Token><LogFilePath /><CfgFilePath>%COMMONAPPDATA%\Canon\OIPPESP\Cfg\Cnpspupd.cfg</CfgFilePath></actor>
        <actor type="maintenance" as="AsUser"><path>%PROGPATH%\Canon\OIPPESP\Cnpspupl.exe</path><Token>PESPMaintenanceToken</Token><LogFilePath /><CfgFilePath>%COMMONAPPDATA%\Canon\OIPPESP\Cfg\Cnpspmnt.cfg</CfgFilePath></actor>
        <actor type="blackboard" as=""><path>%COMMONAPPDATA%\Canon\OIPPESP\BB\PESPBlackboard.xml</path><Token>PESPBlackboardToken</Token><LogFilePath /><CfgFilePath /></actor>
      </actors>
      <program><ALM>%COMMONAPPDATA%\Canon\OIPPESP\ALM</ALM><interval>25920000000000</interval><maxinning>120</maxinning></program>
      <BlackBoardTemplate>
        <PESPBlackboard ver="1.0">
          <file><creation /><creator /><modified /><modifiedby /><history capacity='10' trigger='ON'/></file>
          <program><ALM>%COMMONAPPDATA%\Canon\OIPPESP\ALM</ALM><UploadingTerm>12096000000000</UploadingTerm><CollectionTerm>12096000000000</CollectionTerm></program>
          <notification />
          <score><common><epoch /><end /><hostid /><PAT /></common><targets /><scoreboard><score inning="1" CST="NY" UST="NY" SCHD="" CS="" CE="" US="" UE="" PRN="" ALM="" ALMco="" /></scoreboard></score>
          <memo><controller><wakeup /></controller><logger><wakeup /></logger><collector><wakeup /></collector><uploader><wakeup /></uploader><updater><wakeup /></updater></memo>
        </PESPBlackboard>
      </BlackBoardTemplate>
    </task>
  </TaskConfiguration>
  
  <ConfigurationTemplate>
    <Common alias="config"><CrashH*******ler trigger="ON"><filepath>%COMMONAPPDATA%\Canon\OIPPESP\Log</filepath><maxCrash>4</maxCrash><dumpFlag>0</dumpFlag></CrashH*******ler><DFC ver="1.0"><Application><Longevity trigger="ON" >1800</Longevity></Application><Logger ver="1.0"><OpeningMessage trigger="OFF" /><filter trigger="ON">NONE +PESP +DFC</filter><destinations><dest type="network" trigger="ON"><server>localhost</server><type>UDP</type><port /><Level>{967B6080-P3E7-ED73-S45C-P7A50A0617F9}</Level></dest></destinations></Logger></DFC><Actor ver=""><Token /><Blackboard><Path>%COMMONAPPDATA%\Canon\OIPPESP\BB\PESPBlackboard.xml</Path><Token>PESPBlackboardToken</Token></Blackboard></Actor></Common>
 
    <Specific type="logger">
      <Item id="1" opr="append" pos="//config/DFC/Logger"><sources><src protocol="udp" port="" trigger="ON" /></sources></Item>
      <Item id="2" opr="remove" pos="//config/DFC/Logger/destinations/dest[@type='network']" />
      <Item id="3" opr="append" pos="//config/Actor"><destinations><dest type="file" trigger="ON"><filepath>%COMMONAPPDATA%\Canon\OIPPESP\Log\PESP.log</filepath><MaxSize unit="MByte">1</MaxSize><MaxFiles>4</MaxFiles><Level>80</Level></dest></destinations></Item>
      <Item id="4" opr="append" pos="//config/Actor"><lifetime><DefaultLife/><LossTime/><DeadLine/></lifetime></Item>
      <Item id="5" opr="append" pos="//config/Actor"><actors><actor type="controller"><Token>PESPControllerToken</Token></actor><actor type="collector"><Token>PESPCollectorToken</Token></actor><actor type="uploader"><Token>PESPUploaderToken</Token></actor><actor type="logger"><Token>PESPLoggerToken</Token></actor><actor type="updater"><Token>PESPUpdaterToken</Token></actor><actor type="maintenance"><Token>PESPMaintenanceToken</Token></actor></actors></Item>
    </Specific>
	
    <Specific type="controller">
      <Item id="1" opr="append" pos="//config/DFC/Logger/destinations"></Item>
      <Item id="2" opr="append" pos="//config/Actor"><TaskSchedulerRegistration><Folder>\Canon\OIPPESP</Folder><TaskName>Canon OIP Product Extended Survey Program</TaskName></TaskSchedulerRegistration><Installation><DisplayName>Canon Laser Printer/Scanner/Fax Extended Survey Program</DisplayName><ProductCode platform="32">{4D7B6C53-B3E7-4D93-B27C-B7A50A9627C9}</ProductCode><ProductCode platform="64">{8A16FF47-A5FC-49A8-96B5-31180D317059}</ProductCode></Installation></Item>
    </Specific>
	
    <Specific type="collector">
      <Item id="1" opr="append" pos="//config/DFC/Logger/destinations"></Item>
      <Item id="2" opr="append" pos="//config/Actor"><forcemode trigger="OFF" /><get2mode trigger="OFF" /><atomicmode trigger="ON" /><sleeptime>0</sleeptime><CollectPortKinds><Port>2</Port><Port>23</Port><Port>50</Port><Port>100</Port></CollectPortKinds></Item>
      <Item id="3" opr="append" pos="//config/Actor">
      <Filters>
          <Filter Type="Depend" Judge="No" PortFamily="0" Priority="0">CNXPSP02.DAT</Filter>
          <Filter Type="Depend" Judge="No" PortFamily="50" Priority="0">CNXPSP03.DAT</Filter>
          <Filter Type="Depend" Judge="Yes" PortFamily="0" Priority="100">CNXPSP01.DAT</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon LASER</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon C LBP</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon CP</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon GP</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon FAX</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon iC</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon CLC</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon BIJ</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon iPR</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon S</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon LBP</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon iR-ADV</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon iR</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon Office</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon Graphic</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon Large</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon Universal</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon Generic</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon GLX</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF8100</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF5600</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF5700</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF3110</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF7200</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF7100</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF6500</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF8100</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF4600</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon L1000</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon LC800/L3000</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF7300/7400</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF9100/9300</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF8400</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF7400</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF5800</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon D1100</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF9200</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF8300</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF8000</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF6700</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon D1300/MF6700</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon LC600</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF3200</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF4100</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF4010</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF4200</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF4360-4390</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon L90/L160/L230</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon L140/L130</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon D460-490</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF4320-4350</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon D400-450</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF4500</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon MF4400</Filter>
          <Filter Type="Driver" Judge="No" PortFamily="50" Priority="1000">Canon D500</Filter>
          <Filter Type="Depend" Judge="Yes" PortFamily="0" Priority="100000">CNAS0MOK.DLL</Filter>
          <Filter Type="Depend" Judge="Yes" PortFamily="0" Priority="100000">CNXDIAS2.DLL</Filter>
      </Filters>
      <ChangingPortFamily>
          <Item Src="50" Dst="100">CNAP3PSP.INI</Item>
          <Item Src="2" Dst="2">CNAP3PSP.INI</Item>
          <Item Src="23" Dst="23">CNAP3PSP.INI</Item>
      </ChangingPortFamily>
      <DeviceLists>
          <DeviceList type="White">%PROGPATH%\Canon\OIPPESP\CnpspWhl.dat</DeviceList>
      </DeviceLists>
      </Item>   
    </Specific>
	
    <Specific type="uploader">
      <Item id="1" opr="append" pos="//config/DFC/Logger/destinations"></Item>
      <Item id="2" opr="append" pos="//config/Actor"><MaxNumberOfSendingALMs>360</MaxNumberOfSendingALMs><forcemode trigger="OFF" /><timeout>30000</timeout><retry>3</retry></Item>
      <Item id="3" opr="append" pos="//config/Actor"><Installation><DisplayName>Canon Laser Printer/Scanner/Fax Extended Survey Program</DisplayName><ProductCode platform="32">{4D7B6C53-B3E7-4D93-B27C-B7A50A9627C9}</ProductCode><ProductCode platform="64">{8A16FF47-A5FC-49A8-96B5-31180D317059}</ProductCode></Installation></Item>
    </Specific>
	
	<specific type="maintenance" >
	  <Item id="1" opr="append" pos="//config/Actor"><PAT trigger="ON"/></Item>
	</specific>
	
    <Specific type="updater" />
	
  </ConfigurationTemplate>
</Configuration>
